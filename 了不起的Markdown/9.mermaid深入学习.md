# mermaid

## flowchart基本语法

### flowchart方向

- TB - top to bottom
- TD - top-down/ same as top to bottom
- BT - bottom to top
- RL - right to left
- LR - left to right

### 节点

```mermaid
flowchart LR
默认方形
id1[方形]
id2(圆边矩形)
id3([体育场形])
id4[[子程序形]]
id5[(圆柱形)]
id6((圆形))
id7>不对称形]
id8{菱形}
id9{{六角形}}
id10[/平行四边形/]
id11[\反向平行四边形\]
id12[/梯形\]
id13[\反向梯形/]
id14(((同心圆形)))
```

### 节点之间的链接

```mermaid
flowchart LR
A --- B
C --> D
E === F
G ==> H
I -.- J
K -.-> L
```

```mermaid
flowchart LR
A --文本--- B
C --文本--> D
E ==文本=== F
G ==文本==> H
I -.文本.- J
K -.文本.-> L
```

```mermaid
flowchart LR
A ---|文本| B
C -->|文本| D
E ===|文本| F
G ==>|文本| H
I -.-|文本| J
K -.->|文本|L
```

### 多链接

```mermaid
flowchart LR
A--文本-->B--文本-->C
```

```mermaid
flowchart LR
a --> b & c--> d
```

```mermaid
flowchart TB
    A & B--> C & D
```

```mermaid
flowchart TB
    A --> C
    A --> D
    B --> C
    B --> D
```

### 新链接

```mermaid
flowchart LR
    A --o B
    B --x C
```

### 多向剪头

```mermaid
flowchart LR
    A o--o B
    B <--> C
    C x--x D
```

### 链接最小长度

| Length            | 1      | 2       | 3        |
| ----------------- | ------ | ------- | -------- |
| Normal            | `---`  | `----`  | `-----`  |
| Normal with arrow | `-->`  | `--->`  | `---->`  |
| Thick             | `===`  | `====`  | `=====`  |
| Thick with arrow  | `==>`  | `===>`  | `====>`  |
| Dotted            | `-.-`  | `-..-`  | `-...-`  |
| Dotted with arrow | `-.->` | `-..->` | `-...->` |

```mermaid
flowchart TD
    A[Start] --> B{Is it?}
    B -->|Yes| C[OK]
    C --> D[Rethink]
    D --> B
    B ---->|No| E[End]
```

```mermaid
flowchart TD
    A[Start] --> B{Is it?}
    B -- Yes --> C[OK]
    C --> D[Rethink]
    D --> B
    B -- No ----> E[End]
```

### 特殊字符

```mermaid
flowchart LR
    id1["方形节点中的（文本）"]
```

### 转义字符

```mermaid
flowchart LR
A["A double quote:#quot;"] -->B["A dec char:#9829;"]
```

### 子图

```mermaid
flowchart TB
    c1-->a2
    subgraph one
    a1-->a2
    end
    subgraph two
    b1-->b2
    end
    subgraph three
    c1-->c2
    end
```

### 流程图

```mermaid
flowchart TB
    c1-->a2
    subgraph one
    a1-->a2
    end
    subgraph two
    b1-->b2
    end
    subgraph three
    c1-->c2
    end
    one --> two
    three --> two
    two --> c2
```

### 子图中的方向

```mermaid
flowchart LR
  subgraph TOP
    direction TB
    subgraph B1
        direction RL
        i1 -->f1
    end
    subgraph B2
        direction BT
        i2 -->f2
    end
  end
  A --> TOP --> B
  B1 --> B2
```

## Sequence diagrams

| Type | Description                                                                       |
| ---- | --------------------------------------------------------------------------------- |
| ->   | Solid line without arrow 不带箭头实线                                             |
| -->  | Dotted line without arrow  不带箭头虚线                                           |
| ->>  | Solid line with arrowhead  带箭头实线                                             |
| -->> | Dotted line with arrowhead  带箭头虚线                                            |
| -x   | Solid line with a cross at the end 末端有十字的实线                               |
| --x  | Dotted line with a cross at the end.  末端有十字的虚线                            |
| -)   | Solid line with an open arrow at the end (async) 末端有一个打开箭头的实线（异步） |
| --)  | Dotted line with a open arrow at the end (async) 末尾带有打开箭头的虚线（异步）   |

| 片段类型 | 名称   | 说明                                                         |
| -------- | ------ | ------------------------------------------------------------ |
| Opt      | 选项   | 包含一个可能发生或可能不发生的序列。可以在临界中指定序列发生的条件。 |
| Alt      | 抉择   | 包含一个片段列表,这些片段包含备选消息序列。在任何场合下只发生一个序列。可以在每个片段中设置一个临界来指示该片段可以运行的条件。 else 的临界指示其他任何临界都不为 True 时应运行的片段。如果所有临界都为 false 并且没有 else ,则不执行任何片段。 |
| Loop     | 循环   | 片段重复一定次数。可以在临界中指示片段重复的条件。Loop 组合片段具有“Min”和"Max"属性,它们指示片段可以重复的最小和最大次数。默认值是无限制。 |
| Break    | 中断   | 如果执行此片段,则放弃序列的其余部分。可以使用临界来指示发 生中断的条件。 |
| Par      | 并行   | 并行处理。片段中的事件可以交错。                             |
| Critical | 关键   | 用在 Par 或 Seq 片段中。指示此片段中的消息不得与其他消息交错。 |
| Seq      | 弱顺序 | 有两个或更多操作数片段。涉及同一生命线的消息必须以片段的顺序发生。如果消息涉及的生命线不同 ,来自不同片段的消息可能会并行交错。 |
| Strict   | 强顺序 | 有两个或更多操作数片段。这些片段必须按给定顺序发生。         |
| Consider | 考虑   | 指定此片段描述的消息列表。其他消息可发生在运行的系统中,但对此描述来说意义不大。在"Messages"属性中键入该列表。 |
| Ignore   | 忽略   | 此片段未描述的消息列表。这些消息可发生在运行的系统中 ，但对此描述来说意义不大。在"Messages"属性中键入该列表。 |
| Assert   | 断言   | 操作数片段指定唯一有效的序列。 通常用在 Consider 或 Ignore 片段中。 |
| Neg      | 否定   | 此片段中显示的序列不得发生。通常用在 Consider 或 Ignore 片段中。 |

### 演员

```mermaid
sequenceDiagram
    actor 爱丽丝
    actor 鲍勃
    爱丽丝->>鲍勃: 嗨，鲍勃
    鲍勃->>爱丽丝: 嗨，爱丽丝
```

### 别名

```mermaid
sequenceDiagram
    participant A as 爱丽丝
    participant J as 约翰
    A->>J: 你好，约翰，你好吗？
    J->>A: 很好！
```

### 控制焦点

```mermaid
sequenceDiagram
    爱丽丝->>约翰: 你好，约翰，你好吗？
    activate 约翰
    约翰-->>爱丽丝: 很好！
    deactivate 约翰
```

- 还有一个快捷方式表示法，通过将 / 后缀附加到消息箭头：`+` `-`

```mermaid
sequenceDiagram
    爱丽丝->>+约翰: 你好，约翰，你好吗？
    约翰-->>-爱丽丝: 很好！
```

- 可以为同一个参与者堆叠激活

```mermaid
sequenceDiagram
    爱丽丝->>+约翰: Hello 约翰, 你好吗?
    爱丽丝->>+约翰: 约翰, 你能听见我说话吗?
    约翰-->>-爱丽丝: Hi 爱丽丝, 我能听见!
    约翰-->>-爱丽丝: 我感觉很棒!
```

### 注释

- 右侧注释

```mermaid
sequenceDiagram
    participant 约翰
    Note right of 约翰: Text in note
```

- 上方注释

```mermaid
sequenceDiagram
    爱丽丝->约翰: Hello 约翰, how are you?
    Note over 爱丽丝,约翰: A typical interaction
```

### 循环

```mermaid
sequenceDiagram
    爱丽丝->约翰: Hello 约翰, how are you?
    loop 每分钟
        约翰-->爱丽丝: Great!
    end
```

### 替代路径

```mermaid
sequenceDiagram
    爱丽丝->>鲍勃: Hello 鲍勃, how are you?
    alt 生病了
        鲍勃->>爱丽丝: 不太好
    else 很好
        鲍勃->>爱丽丝: 感觉很舒心
    end
    opt 额外响应
        鲍勃->>爱丽丝: 感谢你的提问
    end
```

### 并行

```mermaid
sequenceDiagram
    par 爱丽丝对鲍勃
        爱丽丝->>鲍勃: 大家好!
    and 爱丽丝约翰约翰
        爱丽丝->>约翰: 大家好!
    end
    鲍勃-->>爱丽丝: Hi 爱丽丝!
    约翰-->>爱丽丝: Hi 爱丽丝!
```

- 也可以嵌套并行块。

```mermaid
sequenceDiagram
    par 爱丽丝对鲍勃
        爱丽丝->>鲍勃: 去帮助约翰
    and 爱丽丝对约翰
        爱丽丝->>约翰: 我想今天完成
        par 约翰对查理
            约翰->>查理: 我们今天能做到吗?
        and 约翰对戴安娜
            约翰->>戴安娜: 你今天能帮助我们吗?
        end
    end
```

```mermaid
sequenceDiagram
    critical Establish a connection to the DB
        Service-->DB: connect
    option Network timeout
        Service-->Service: Log error
    option Credentials rejected
        Service-->Service: Log different error
    end
```

```mermaid
sequenceDiagram
    critical Establish a connection to the DB
        Service-->DB: connect
    end
```
